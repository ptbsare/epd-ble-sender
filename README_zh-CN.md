# EPD BLE Sender - ç”µå­å¢¨æ°´å±è“ç‰™å‘é€å·¥å…·

è¿™æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºé€šè¿‡ä½åŠŸè€—è“ç‰™ï¼ˆBLEï¼‰å°†å›¾åƒå’Œæ–‡æœ¬å‘é€åˆ°å„ç§ç”µå­å¢¨æ°´å±ï¼ˆE-Paper Display, EPDï¼‰ä¸Šã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

- **å¤šç§å†…å®¹æº**: æ”¯æŒç›´æ¥å‘é€æœ¬åœ°å›¾åƒæ–‡ä»¶æˆ–é€šè¿‡å‘½ä»¤è¡ŒåŠ¨æ€ç”Ÿæˆæ–‡æœ¬å›¾åƒã€‚
- **é«˜çº§æ–‡æœ¬æ’ç‰ˆ**: 
    - ä½¿ç”¨ç®€å•çš„æ ‡è®°è¯­è¨€ï¼Œå¯ä»¥ç²¾ç¡®æ§åˆ¶æ¯ä¸€è¡Œæ–‡æœ¬çš„ **å­—ä½“å¤§å°**ã€**å¯¹é½æ–¹å¼**ï¼ˆå·¦/ä¸­/å³ï¼‰å’Œ **å­—ä½“**ã€‚
    - å¯å°†æ–‡æœ¬é¢œè‰²è®¾ç½®ä¸º **é»‘**ã€**çº¢**ã€**ç™½**ã€‚
    - å¯å°†å›¾åƒèƒŒæ™¯è‰²è®¾ç½®ä¸º **ç™½**ã€**é»‘**ã€**çº¢**ã€‚
- **è®¾å¤‡æ¨¡å¼æ§åˆ¶**: ä½¿ç”¨ç®€å•å‘½ä»¤å³å¯åœ¨ **æ—¥å†æ¨¡å¼**ã€**æ—¶é’Ÿæ¨¡å¼**ä¹‹é—´åˆ‡æ¢ï¼Œæˆ–**æ¸…ç©ºå±å¹•**ã€‚
- **æ™ºèƒ½è®¾å¤‡å‘ç°**: è‡ªåŠ¨æ‰«æå¹¶è¿æ¥åˆ°æŒ‡å®šçš„BLEè®¾å¤‡ï¼Œå¹¶èƒ½é€šè¿‡è®¾å¤‡é€šçŸ¥è‡ªåŠ¨æ£€æµ‹å±å¹• **åˆ†è¾¨ç‡** å’Œ **MTU** å¤§å°ã€‚
- **ä¸°å¯Œçš„å›¾åƒå¤„ç†**:
    - **å¤šç§æŠ–åŠ¨ç®—æ³•**: å†…ç½® `Floyd-Steinberg`, `Atkinson`, `Jarvis-Stucki`, `Stucki`, å’Œ `Bayer` ç®—æ³•ï¼Œä»¥ä¼˜åŒ–åœ¨é»‘ç™½æˆ–ä¸‰è‰²å±å¹•ä¸Šçš„å›¾åƒæ˜¾ç¤ºæ•ˆæœã€‚
    - **çµæ´»çš„ç¼©æ”¾æ¨¡å¼**: æ”¯æŒ `stretch`ï¼ˆæ‹‰ä¼¸ï¼‰ã€`fit`ï¼ˆé€‚åº”ï¼‰å’Œ `crop`ï¼ˆè£å‰ªï¼‰æ¨¡å¼ï¼Œä»¥åŒ¹é…å±å¹•å°ºå¯¸ã€‚
- **å¼ºå¤§çš„é²æ£’æ€§**:
    - **è‡ªåŠ¨é‡è¿**: åœ¨é‡åˆ°è¿æ¥ä¸­æ–­æˆ–ä¼ è¾“é”™è¯¯æ—¶ï¼Œä¼šè‡ªåŠ¨å°è¯•é‡æ–°è¿æ¥ã€‚
    - **æŒ‡æ•°é€€é¿**: é‡è¿å°è¯•ä¹‹é—´ä¼šé‡‡ç”¨æŒ‡æ•°çº§å¢é•¿çš„ç­‰å¾…æ—¶é—´ï¼Œå¤§å¤§æé«˜äº†åœ¨ä¸ç¨³å®šç¯å¢ƒä¸‹çš„æˆåŠŸç‡ã€‚

## âš™ï¸ å®‰è£…ä¸è¿è¡Œ

æœ¬é¡¹ç›®ä½¿ç”¨ [uv](https://github.com/astral-sh/uv) ä½œä¸ºåŒ…ç®¡ç†å’Œè¿è¡Œå·¥å…·ï¼Œå®ƒæä¾›äº†æå¿«çš„ä¾èµ–è§£æé€Ÿåº¦ã€‚

1.  **åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ**
    ```bash
    uv venv
    ```

2.  **æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ**
    -   Linux / macOS:
        ```bash
        source .venv/bin/activate
        ```
    -   Windows (PowerShell):
        ```powershell
        .venv\Scripts\Activate.ps1
        ```

3.  **åŒæ­¥ä¾èµ–**
    ```bash
    uv sync
    ```

## ğŸš€ ä½¿ç”¨æ–¹æ³•

`uv run` å‘½ä»¤å¯ä»¥ç¡®ä¿å³ä½¿æ‚¨å¿˜è®°æ¿€æ´»è™šæ‹Ÿç¯å¢ƒï¼Œä¹Ÿèƒ½ä½¿ç”¨æ­£ç¡®çš„Pythonè§£é‡Šå™¨å’Œä¾èµ–ã€‚

### 1. æ‰«æè®¾å¤‡

é¦–å…ˆï¼Œæ‰«æé™„è¿‘çš„BLEè®¾å¤‡ä»¥æ‰¾åˆ°ä½ çš„ç”µå­å¢¨æ°´å±çš„åœ°å€ã€‚

```bash
uv run src/main.py scan
```
è®°ä¸‹ä½ çš„è®¾å¤‡åœ°å€ï¼Œä¾‹å¦‚ `XX:XX:XX:XX:XX:XX`ã€‚

### 2. å‘é€å†…å®¹

ä½¿ç”¨ `send` å‘½ä»¤å‘é€å›¾åƒæˆ–æ–‡æœ¬ã€‚

**å‘é€å›¾åƒ:**
```bash
uv run src/main.py send --address XX:XX:XX:XX:XX:XX --image /path/to/your/image.png --color-mode bwr --dither floyd
```

**ä½¿ç”¨é«˜çº§æ–‡æœ¬æ’ç‰ˆ:**
```bash
# æ­¤å‘½ä»¤åˆ›å»ºä¸€ä¸ªç™½è‰²èƒŒæ™¯ï¼ˆé»˜è®¤ï¼‰çš„å›¾åƒ
uv run src/main.py send --address XX:XX:XX:XX:XX:XX \
--text "[size=40,align=center]å¤©æ°”é¢„æŠ¥\n[color=red,size=20]é«˜æ¸©è­¦å‘Š\n[align=right]2025-08-02" \
--color-mode bwr
```

**ä½¿ç”¨è‡ªå®šä¹‰èƒŒæ™¯å’Œæ–‡æœ¬é¢œè‰²:**
```bash
# æ­¤å‘½ä»¤åˆ›å»ºä¸€ä¸ªé»‘è‰²èƒŒæ™¯å’Œç™½è‰²æ–‡æœ¬çš„å›¾åƒ
uv run src/main.py send --address XX:XX:XX:XX:XX:XX \
--text "[size=30,color=white,align=center]å¤œé—´æ¨¡å¼" \
--bg-color black
```

### 3. åˆ‡æ¢æ˜¾ç¤ºæ¨¡å¼

ä½ å¯ä»¥åˆ‡æ¢è®¾å¤‡å†…ç½®çš„æ˜¾ç¤ºæ¨¡å¼ï¼Œåœ¨æ—¥å†å’Œæ—¶é’Ÿä¹‹é—´é€‰æ‹©ã€‚

**åˆ‡æ¢åˆ°æ—¥å†æ¨¡å¼:**
```bash
uv run src/main.py calendar --address XX:XX:XX:XX:XX:XX
```

**åˆ‡æ¢åˆ°æ—¶é’Ÿæ¨¡å¼:**
```bash
uv run src/main.py clock --address XX:XX:XX:XX:XX:XX
```

### 4. æ¸…ç©ºå±å¹•

**å‘é€æ¸…å±å‘½ä»¤:**
```bash
uv run src/main.py clear --address XX:XX:XX:XX:XX:XX
```

## ğŸ“š å‘½ä»¤è¡Œé€‰é¡¹å‚è€ƒ

### `scan` å‘½ä»¤
- `--adapter TEXT`: æŒ‡å®šè¦ä½¿ç”¨çš„è“ç‰™é€‚é…å™¨ (ä¾‹å¦‚ `hci0`)ã€‚

### `send` å‘½ä»¤
- `--address TEXT`: **(å¿…éœ€)** ç›®æ ‡è®¾å¤‡çš„BLEåœ°å€ã€‚
- `--image TEXT`: è¦å‘é€çš„å›¾åƒæ–‡ä»¶è·¯å¾„ã€‚
- `--text TEXT`: è¦æ¸²æŸ“å¹¶å‘é€çš„æ–‡æœ¬å†…å®¹ã€‚æ”¯æŒ `\n` æ¢è¡Œã€‚
- `--font TEXT`: é»˜è®¤å­—ä½“æ–‡ä»¶çš„è·¯å¾„ã€‚
- `--size INTEGER`: é»˜è®¤å­—ä½“å¤§å°ã€‚
- `--color TEXT`: é»˜è®¤æ–‡æœ¬é¢œè‰² (`black`, `red`, æˆ– `white`)ã€‚
- `--bg-color [white|black|red]`: ä¸ºæ–‡æœ¬æ¸²æŸ“è®¾ç½®èƒŒæ™¯é¢œè‰² (é»˜è®¤ä¸º `white`)ã€‚
- `--width INTEGER`: æ‰‹åŠ¨æŒ‡å®šå±å¹•å®½åº¦ã€‚
- `--height INTEGER`: æ‰‹åŠ¨æŒ‡å®šå±å¹•é«˜åº¦ã€‚
- `--clear`: å‘é€å‰æ¸…ç©ºå±å¹•ã€‚
- `--color-mode [bw|bwr]`: é¢œè‰²æ¨¡å¼ã€‚`bw` ä¸ºé»‘ç™½ï¼Œ`bwr` ä¸ºé»‘ç™½çº¢ä¸‰è‰²ã€‚
- `--dither [auto|none|floyd|atkinson|jarvis|stucki|bayer]`: ä½¿ç”¨çš„æŠ–åŠ¨ç®—æ³•ã€‚'auto' æ¨¡å¼ä¸‹ï¼Œä¸ºå›¾ç‰‡å¯ç”¨æŠ–åŠ¨ï¼Œä¸ºæ–‡æœ¬ç¦ç”¨æŠ–åŠ¨ã€‚
- `--resize-mode [stretch|fit|crop]`: å›¾åƒç¼©æ”¾æ¨¡å¼ã€‚
- `--interleaved-count INTEGER`: å‘é€å¤šå°‘ä¸ªæ•°æ®å—åç­‰å¾…ä¸€æ¬¡è®¾å¤‡å“åº”ã€‚
- `--retry INTEGER`: è¿æ¥å¤±è´¥æ—¶çš„æœ€å¤§é‡è¯•æ¬¡æ•°ã€‚

### `calendar` å‘½ä»¤
- `--address TEXT`: **(å¿…éœ€)** ç›®æ ‡è®¾å¤‡çš„BLEåœ°å€ã€‚
- `--adapter TEXT`: æŒ‡å®šè¦ä½¿ç”¨çš„è“ç‰™é€‚é…å™¨ (ä¾‹å¦‚ `hci0`)ã€‚

### `clock` å‘½ä»¤
- `--address TEXT`: **(å¿…éœ€)** ç›®æ ‡è®¾å¤‡çš„BLEåœ°å€ã€‚
- `--adapter TEXT`: æŒ‡å®šè¦ä½¿ç”¨çš„è“ç‰™é€‚é…å™¨ (ä¾‹å¦‚ `hci0`)ã€‚

### `clear` å‘½ä»¤
- `--address TEXT`: **(å¿…éœ€)** ç›®æ ‡è®¾å¤‡çš„BLEåœ°å€ã€‚
- `--adapter TEXT`: æŒ‡å®šè¦ä½¿ç”¨çš„è“ç‰™é€‚é…å™¨ (ä¾‹å¦‚ `hci0`)ã€‚

## ğŸ“¦ æ‰“åŒ…ä¸ºå¯æ‰§è¡Œæ–‡ä»¶

ä½ å¯ä»¥ä½¿ç”¨ `PyInstaller` å°†æ­¤å·¥å…·æ‰“åŒ…æˆä¸€ä¸ªç‹¬ç«‹çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ–¹ä¾¿åœ¨æ²¡æœ‰Pythonç¯å¢ƒçš„æœºå™¨ä¸Šè¿è¡Œã€‚

1.  **å®‰è£… PyInstaller**
    ```bash
    uv pip install pyinstaller
    ```

2.  **æ‰§è¡Œæ‰“åŒ…**

    > **æ³¨æ„**: `--add-data` å‚æ•°å¯¹äºå°†é»˜è®¤å­—ä½“æ–‡ä»¶åŒ…å«åˆ°å¯æ‰§è¡Œæ–‡ä»¶ä¸­è‡³å…³é‡è¦ã€‚è¯·æ ¹æ®ä½ çš„ç³»ç»Ÿä¿®æ”¹å­—ä½“è·¯å¾„ã€‚

    -   **Linux / macOS:**
        ```bash
        pyinstaller --onefile --name epd-sender \
        --add-data="/usr/share/fonts/truetype/dejavu/DejaVuSans.ttf:." \
        src/main.py
        ```
    -   **Windows:** (å‡è®¾å­—ä½“åœ¨ `C:\Windows\Fonts\arial.ttf`)
        ```powershell
        pyinstaller --onefile --name epd-sender.exe `
        --add-data="C:\Windows\Fonts\arial.ttf;." `
        src/main.py
        ```
    æ‰“åŒ…æˆåŠŸåï¼Œä½ ä¼šåœ¨ `dist` ç›®å½•ä¸‹æ‰¾åˆ° `epd-sender` æˆ– `epd-sender.exe` æ–‡ä»¶ã€‚